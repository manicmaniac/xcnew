; See https://reverse.put.as/wp-content/uploads/2011/09/Apple-Sandbox-Guide-v1.0.pdf for syntax.
; To see log of sandbox, run `log stream --level error --predicate 'process = "kernel" AND sender = "Sandbox"'`

(version 1)

(deny default)
(allow process-exec*
    (regex #"XCBBuildService$")
    (regex #"ibtoold$")
    (regex #"xcnew$"))
(allow process-fork)
(allow ipc-posix-shm*)
(allow mach-lookup)
(allow file-ioctl
    (literal "/dev/dtracehelper"))
(allow file-read*)
(allow file-write*
    (literal "/dev/dtracehelper")
    (literal "/dev/null")
    (regex #"^/Users/[0-9A-Za-z_]+/Library/Caches/com\.apple\.dt\.Xcode/Downloads/[0-9A-F]+\.dvtdownloadableindex")
    (subpath "/private/var/folders"))
(allow iokit-open)
(allow job-creation)
(allow sysctl*)
(allow system-fsctl)
(allow user-preference-read)
(allow user-preference-write)
